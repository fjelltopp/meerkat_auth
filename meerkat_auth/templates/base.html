<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>{{ _('Authentication and User Management | Meerkat Public Health Surveillance') }}</title>
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/main.css') }}" />
  <script>
  language = "{{g.get('language')|safe}}";
  </script>
  {% block head %} {% endblock %}
</head>
<body>

<!-- NAVBAR -->
  <nav class="navbar navbar-fixed-top">
    <div class="container navmenu">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu-collapse" aria-expanded="false">
          <span class="sr-only">{{ _('Toggle navigation') }}</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <div class="navbar-brand scroll-top">
          <span class="hidden-xs hidden-sm">
            <b>{{_('Authentication and User Management')}}</b> &middot; {{_('Meerkat Public Health Surveillance')}}
          </span>
          <span class="visible-xs visible-sm"><b>User Manager</b> &middot; Meerkat </span>
        </div>
      </div>
      <div class="collapse navbar-collapse" id="menu-collapse" >
        {% block menu %}
        <ul class="nav navbar-nav">
          <li class="navbar-nav__users"><a href="/{{g.get('language')}}/users/" >{{ _('Users') }}</a></li>
          <li class="navbar-nav__roles"><a href="/{{g.get('language')}}/roles/" >{{ _('Roles') }}</a></li>
        </ul>
        {% endblock %}
        <div class="lang-sel">
        </div>
      </div>
    </div>
  </nav>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
	 <ul class='container flashes'>
	 {% for category, message in messages %}
	   <li>
			<div class="frame {{category}}">
				<span class="glyphicon glyphicon-alert" ></span>
				<div class='text'>
					{{ _(message) }}
				</div>
			</div>
		</li>
	 {% endfor %}
	 </ul>
  {% else %}
    <div id="base-breaker" class="breaker"> </div>
  {% endif %}
{% endwith %}
    <div class="page-content container">
    {% block body %}{% endblock %}
    </div>
    <!-- FOOTER -->
    <footer class="row">
      {% block footer %}
      <div class="container">
	      <div class="footer__label pull-right col-xs-12 col-sm-6 col-md-5 less-padding-col">
		      {{_('Meerkat Public Health Surveillance')}} 
	      </div>
      </div>
      {% endblock %}
    </footer>

<!-- JS -->
<script src="{{ url_for('static', filename='js/jquery.js') }}"></script>
<script src="{{ url_for('static', filename='js/bootstrap.js') }}"></script>
<script src="{{ url_for('static', filename='js/jed.js') }}"></script>
<script src="{{ url_for('static', filename='js/app.js') }}"></script>
<script src="{{ url_for('static', filename='js/moment.js') }}"></script>
<script src="{{ url_for('static', filename='js/locale/fr.js') }}"></script>
<script>
  //Draw the langauge selector.
  var languages = {{ config["SUPPORTED_LANGUAGES"]|tojson|safe }};
  var currentLang = "{{ g.get("language", None)|safe }}";
  var index = languages.indexOf( currentLang );
  var nextLang = index == languages.length-1 ? languages[0] : languages[index+1];
  var nextLangHref = window.location.href.replace( '/' + currentLang + '/', '/' + nextLang + '/' );

  $('.lang-sel').html( "<a class='lang " + currentLang + "' href='" + nextLangHref + "'>" +
                       nextLang.toUpperCase() + "</a>" );
  $(".lang-sel").attr( 'title', i18n.gettext("Choose a language") ); //Translatable tool tip.

</script>
  {% block pageJS %}{% endblock %}
  </body>
</html>
